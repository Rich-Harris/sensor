(function(e){var t,n,o,r,c,s,a,u;t=function(e){var t;if(e||(e=window),"string"==typeof e&&(e=getElFromString(e),!e))throw Error("Could not find specified element");if(e.__sensor)return e.__sensor;if(!(e instanceof Node||e instanceof Window))throw Error("Object must be a DOM node, or the window object");return t=Object.create(n),t.el=e,t.packages={},t.boundEvents={},e.__sensor=t,t},n={on:function(e,t,n){var o,r,c,i,s,a,u=this;if("object"==typeof e){i=e,o=[];for(s in i)i.hasOwnProperty(s)&&("function"==typeof i[s]?(n=i[s],-1!==(a=s.indexOf(" "))?(e=s.substr(0,a),t=s.substring(a+1)):(e=s,t=null)):"object"==typeof i[s]&&(e=s,t=i[s].childSelector,n=i[s].handler),r={eventName:e,childSelector:t,handler:n},this._addPackage(r));return{cancel:function(){if(!c){for(;o.length;)u.off(o.pop());c=!0}}}}return 2===arguments.length&&(n=t,t=null),r={eventName:e,childSelector:t,handler:n},this._addPackage(r),{cancel:function(){c||(u.off(r),c=!0)}}},off:function(e,t,n){var o,r,c,i,s=this;i=function(e){delete s.packages[e],s.boundEvents[e].teardown(),delete s.boundEvents[e]};{if(arguments.length){if(1===arguments.length){if("object"==typeof e){if(r=e,e=r.eventName,o=this.packages[e],!o)return;if(c=o.indexOf(r),-1===c)return;return o.splice(c,1),o.length||i(e),void 0}return i(e),void 0}if(2===arguments.length){if("function"!=typeof t)return o=this.packages[e],o&&(this.packages[e]=o.filter(function(e){return e.childSelector!==t}),this.packages[e].length||i(e)),void 0;n=t,t=null}return this.packages[e]?(this.packages[e]=t?this.packages[e].filter(function(e){return e.childSelector!==t||e.handler!==n}):this.packages[e].filter(function(e){return e.childSelector||e.handler!==n}),this.packages[e].length||i(e),void 0):void 0}for(e in this.boundEvents)this.boundEvents.hasOwnProperty(e)&&i(e)}},once:function(e,t,n){var o;return 2===arguments.length&&(n=t,t=null),o=this.on(e,t,function(){n.apply(this,arguments),o.cancel()})},_addPackage:function(e){var t=e.eventName;this.packages[t]||(this.packages[t]=[]),this.packages[t].push(e),this._bindEvent(t)},_bindEvent:function(e){var t,n=this;t=o[e],t||(t=u(e)),this.boundEvents[e]||(this.boundEvents[e]=!0,this.boundEvents[e]=t.call(null,this.el,this,function(){var t,o,r,i,s;for(t=n.packages[e].slice(),r=0;t.length>r;r+=1)if(o=t[r],o.childSelector){if(i=this,i===n.el)continue;for(;!s&&i!==n.el;)c(i,o.childSelector)&&(s=i),i=i.parentNode;s&&o.handler.apply(s,arguments)}else o.handler.apply(n.el,arguments)}))}},o={},t.define=function(e,t){o[e]=t},function(e){e.matches=e.matches||e.matchesSelector||e.mozMatches||e.mozMatchesSelector||e.msMatches||e.msMatchesSelector||e.oMatches||e.oMatchesSelector||e.webkitMatches||e.webkitMatchesSelector}(Element.prototype),t.patch=function(){r||([Node.prototype,Window.prototype].forEach(function(e){e.on=function(){this.__sensor=t(this),this.__sensor.on.apply(this.__sensor,arguments)},e.off=function(){this.__sensor=t(this),this.__sensor.off.apply(this.__sensor,arguments)}}),r=!0)},s=/^\.([^ ]+)$/,c=function(e,t){var n,o;if("string"==typeof t){if(e.matches)return e.matches(t);if(e.tagName.toLowerCase()===t.toLowerCase())return!0;if(n=s.exec(t))return o=a[t]||function(){return a[t]=RegExp("\\s*"+t+"\\s*")}(),e.className.test(o);throw"This browser does not support matches (aka matchesSelector) - either polyfill it (see e.g. https://github.com/termi/CSS_selector_engine) or only use class names, element arrays, or functions as child selectors"}if("function"==typeof t)return t(e);if(t.length){for(i=t.length;i--;)if(t[i]===e)return!0;return!1}throw"Illegal child selector"},getElFromString=function(e){var t;return document.querySelector&&(t=document.querySelector(e))?t:"#"===e.charAt(0)&&(t=document.getElementById(e.substring(1)))?t:document.getElementById(e)},u=function(e){var n=function(t,n,o){var r=function(e){o.call(e.target,e)};return t.addEventListener(e,r),{teardown:function(){t.removeEventListener(e,r)}}};return t.define(e,n),n},function(e){"use strict";e.define("doubletap",function(e,t,n){var o,r,c;return o=5,r=500,c=t.on("tap",function(e,c){var i=t.on("tap",function(t,r,i){var s=Math.abs(e-t),a=Math.abs(c-r);o>=s&&o>=a&&n(t,r,i)});setTimeout(i.cancel,r)}),{teardown:c.cancel}})}(t),function(e){"use strict";e.define("pullstart",function(e,t,n){var o=t.on("mousedown",function(e){var o,r;o=e.offsetX,r=e.offsetY,t.pull={start:{x:o,y:r},last:{x:o,y:r}},n(o,r,e)});return{teardown:o.cancel}}),e.define("pull",function(e,t,n){var o=t.on("pullstart",function(){var o,r;t.once("mouseup",function(){r.cancel()}),o=function(o){var r,c;r=o.offsetX,c=o.offsetY,n.call(e,r-t.pull.last.x,c-t.pull.last.y),t.pull.last.x=r,t.pull.last.y=c},r=t.on("mousemove",o)});return{teardown:o.cancel}}),e.define("pullend",function(e,t,n){var o=t.on("pullstart",function(){mouseupListener=t.once("mouseup",function(t,o){n.call(e,t,o)})});return{teardown:o.cancel}})}(t),function(e){"use strict";var t=e(window);e.define("tap",function(e,n,o){var r,c,i,s;return r=5,c=200,i=n.on("mousedown",function(e){var n,i,s,a,u,l;u=e.clientX,l=e.clientY,s=function(){a||(i.cancel(),n.cancel(),a=!0)},i=t.on("mouseup",function(t){o.call(e.target,e.offsetX,e.offsetY,t),s()}),n=t.on("mousemove",function(e){var t=e.clientX,n=e.clientY;(Math.abs(t-u)>r||Math.abs(n-l)>r)&&s()}),setTimeout(s,c)}),s=n.on("touchstart",function(e){var n,i,s,a,u,l,f,h,d,p,m;1===e.touches.length&&(n=e.touches[0],i=n.identifier,s=n.target,a=n.clientX,u=n.clientY,p=function(){m||(l.cancel(),h.cancel(),f.cancel(),d.cancel(),m=!0)},l=t.on("touchstart",p),h=t.on("touchend",function(e){o.call(s,n.offsetX,n.offsetY,e),p()}),f=t.on("touchmove",function(e){var t,n,o;t=e.touches[0],n=t.clientX,o=t.clientY,(Math.abs(n-a)>r||Math.abs(o-u)>r)&&p()}),setTimeout(p,c))}),{teardown:function(){i.cancel(),s.cancel()}}})}(t),e.module!==void 0&&e.module.exports?e.module.exports=t:e.define!==void 0&&e.define.amd?e.define(function(){return t}):e.sensor=t})(this);